import{r as M,S as V,M as v,u as y,C as G,a as L,j as i,B as T,b as Z,G as F,V as Q}from"./index-afa845e1.js";const S={LINEAR:"LINEAR",QUADRATIC:"QUADRATIC",BEZIER:"BEZIER",PARAMETRIC:"PARAMETRIC"},q=(t,e=S.BEZIER)=>{switch(e){case"LINEAR":return t;case"QUADRATIC":return t<=.5?2*t*t:2*(t-.5)*(1-(t-.5))+.5;case"BEZIER":return t*t*(3-2*t);case"PARAMETRIC":return t*t/(2*(t*t-t)+1);default:return e}},J=(t,e=0,s=1)=>Math.min(s,Math.max(e,t)),O=(t,e,s)=>t+s*(e-t),X=({scalarTracker:t,nBoxes:e=5,gridSize:s=10,cellSize:a=.25})=>{const h=s,m=s,I=M.useMemo(()=>new V(.65,150,2*250),[250]),u=M.useRef(null),R=M.useMemo(()=>new v,[]),D=y(),C=G.getPalette(D).buildLut(),r=M.useMemo(()=>Array.from({length:e},n=>{const c=Math.floor(h*Math.random()),l=Math.floor(m*Math.random());return{fromRow:c,fromCol:l,toRow:c,toCol:l}}),[e,h,m]);return M.useEffect(()=>{for(let n=0;n<e;n++)u.current.setColorAt(n,C.getColor(n/(e-1)));u.current.instanceColor.needsUpdate=!0},[C,e]),L(()=>{if(I.step((t==null?void 0:t.getNormalizedValue())??0)){const[A,E]=Math.random()>.5?[!0,!1]:[!1,!0];for(let o=0;o<e;o++)r[o].fromRow=r[o].toRow,r[o].fromCol=r[o].toCol,A&&(r[o].toRow+=Math.random()>.5?1:-1),E&&(r[o].toCol+=Math.random()>.5?1:-1)}const n=q(J(I.timeSinceLastEventMs/250)),c=O(Math.PI/4,3*Math.PI/4,n),l=-.5*a*Math.cos(c)/Math.sqrt(2),j=.5*a*Math.sin(c)/Math.sqrt(2);let w,x,p,g,P,d,f;r.forEach(({fromRow:A,fromCol:E,toRow:o,toCol:N},B)=>{d=o-A,f=N-E;const U=A+d*(l+.5),b=E+f*(l+.5);d!==0&&R.makeRotationY((c-Math.PI/4)*d),f!==0&&R.makeRotationX(-(c-Math.PI/4)*f),w=U/(h-1),x=b/(m-1),p=h*a*(w-.5),g=m*a*(x-.5),P=j-a/4,R.setPosition(p,g,P),u.current.setMatrixAt(B,R)}),u.current.instanceMatrix.needsUpdate=!0}),i.jsxs("instancedMesh",{ref:u,castShadow:!0,receiveShadow:!0,args:[new T,new Z,e],children:[i.jsx("boxGeometry",{attach:"geometry",args:[a,a,a,1]}),i.jsx("meshBasicMaterial",{attach:"material",color:"white",toneMapped:!1})]})},z=({scalarTracker:t})=>i.jsxs(i.Fragment,{children:[i.jsx(X,{scalarTracker:t??{getNormalizedValue:()=>Math.sin(.0025*Date.now())+1},nBoxes:200,gridSize:100,cellSize:1}),i.jsx(F,{position:new Q(0,0,-1/2)})]});export{z as default};
