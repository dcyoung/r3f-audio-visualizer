var J=Object.defineProperty;var K=(s,e,n)=>e in s?J(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var V=(s,e,n)=>(K(s,typeof e!="symbol"?e+"":e,n),n);import{r as t,V as R,j as i,u as $,C as X,b as O,B as ee,f as Q,M as te,Q as se,h as P,a as Y,i as ne,c as oe,T,E as re,k as ae}from"./index-73ed3023.js";import{a as ie,D as ce,M as le,w as ue,V as me,E as he,B as xe,N as pe}from"./Noise-f944680c.js";const fe=t.forwardRef(function({blendFunction:e,worldFocusDistance:n,worldFocusRange:c,focusDistance:r,focusRange:l,focalLength:o,bokehScale:x,resolutionScale:u,resolutionX:p,resolutionY:M,width:A,height:f,target:w,depthTexture:a,..._},L){const{camera:H}=t.useContext(ie),k=w!=null,b=t.useMemo(()=>{const B=new ce(H,{blendFunction:e,worldFocusDistance:n,worldFocusRange:c,focusDistance:r,focusRange:l,focalLength:o,bokehScale:x,resolutionScale:u,resolutionX:p,resolutionY:M,width:A,height:f});k&&(B.target=new R),a&&B.setDepthTexture(a.texture,a.packing);const N=B.maskPass;return N.maskFunction=le.MULTIPLY_RGB_SET_ALPHA,B},[H,e,n,c,r,l,o,x,u,p,M,A,f,k,a]);return t.useEffect(()=>()=>{b.dispose()},[b]),i.jsx("primitive",{..._,ref:L,object:b,target:w})}),ge=ue(me),de=s=>(s%T+T)%T;class Z extends ne{constructor(n,c,r,l=0){super();V(this,"helixLength");V(this,"helixRadius");V(this,"helixWindingSeparation");V(this,"helixStartingAngleRad");this.helixLength=n,this.helixRadius=c,this.helixWindingSeparation=r,this.helixStartingAngleRad=de(l)}getPoint(n,c=new R){n-=.5;const l=1/(this.helixLength/this.helixWindingSeparation),o=T*(n%l/l),x=this.helixRadius*Math.cos(o+this.helixStartingAngleRad),u=this.helixRadius*Math.sin(o+this.helixStartingAngleRad),p=this.helixLength*n;return c.set(x,u,p)}}const Me=(s,e)=>Math.hypot(s*Math.sin(e),s*Math.cos(e)-s),I=t.forwardRef(({coordinateMapper:s,helixLength:e=10,helixWindingSeparation:n=10,helixRadius:c=1,strandRadius:r=.1,baseSpacing:l=.35,strandOffsetRad:o=Math.PI/2,mirrorEffects:x=!0,fixedBaseGap:u=!0,...p},M)=>{const{palette:A}=$(),f=X.getPalette(A).buildLut(),w=Math.floor(e/l),a=t.useRef(null),_=t.useMemo(()=>new O({color:"#606060"}),[]),L=t.useMemo(()=>{const m=.45*Me(c,o),d=new ee(r,r,m,1);for(let g=0;g<d.attributes.position.count;g++)d.attributes.position.setZ(g,d.attributes.position.getZ(g)-m/2);return d.attributes.position.needsUpdate=!0,d},[c,r,o]),H=t.useRef(null),k=t.useRef(null),b=t.useMemo(()=>new O({color:f.getColor(.5)}),[f]),[B,N,U,q]=t.useMemo(()=>{const S=new Z(e,c,n,0),m=new Z(e,c,n,o);return[S,new Q(S,100,r,12,!1),m,new Q(m,100,r,12,!1)]},[e,c,n,r,o]),h=t.useMemo(()=>new te,[]),C=t.useMemo(()=>new R,[]),E=t.useMemo(()=>new R,[]),y=t.useMemo(()=>new R,[]),v=t.useMemo(()=>new se,[]),z=t.useMemo(()=>new R(0,0,1),[]);return t.useEffect(()=>{let S=0;for(let m=0;m<w;m++){S=m/Math.max(w-1,1);const d=Math.floor(3.99*P.seededRandom(m)),g=3-d;B.getPoint(S,C),U.getPoint(S,E),h.setPosition(C),h.lookAt(C,E,z),a.current.setMatrixAt(m*2,h),a.current.setColorAt(m*2,f.getColor(d/3)),h.setPosition(E),h.lookAt(E,C,z),a.current.setMatrixAt(m*2+1,h),a.current.setColorAt(m*2+1,f.getColor(g/3))}a.current.instanceMatrix.needsUpdate=!0,a.current.instanceColor.needsUpdate=!0},[B,U,a,w,f,h,C,E,z]),Y(({clock:S})=>{const m=S.getElapsedTime();let d=0,g=0,F=0,W=0;const D=.25,G=1;for(let j=0;j<w;j++)d=j/Math.max(w-1,1),g=s.map(oe.CARTESIAN_1D,x?2*Math.abs(d-.5):d,0,0,m)/s.amplitude,g=(1+g)/2,F=D+(u?2*g:g)*(G-D),W=u?D+2*(1-g)*(G-D):F,a.current.getMatrixAt(j*2,h),h.decompose(C,v,y),y.z=F,h.compose(C,v,y),a.current.setMatrixAt(j*2,h),a.current.getMatrixAt(j*2+1,h),h.decompose(E,v,y),y.z=W,h.compose(E,v,y),a.current.setMatrixAt(j*2+1,h);a.current.instanceMatrix.needsUpdate=!0}),i.jsxs("group",{...p,ref:M,children:[i.jsx("mesh",{ref:H,geometry:N,material:b,castShadow:!0,receiveShadow:!0}),i.jsx("mesh",{ref:k,geometry:q,material:b,castShadow:!0,receiveShadow:!0}),i.jsx("instancedMesh",{ref:a,args:[L,_,2*w],castShadow:!0,receiveShadow:!0})]})});I.displayName="BaseDoubleHelix";const Ae=s=>{const e=[t.useRef(null),t.useRef(null),t.useRef(null),t.useRef(null),t.useRef(null)],n=e.length,c=15,r=Array.from({length:n}).map((l,o)=>new R().fromArray(Array.from({length:3}).map((x,u)=>2*P.seededRandom(o+u)-1)).normalize().multiplyScalar(c));return Y(({clock:l})=>{const o=l.getElapsedTime(),x=5e-4,u=.05;let p,M=0;e.forEach((A,f)=>{A.current&&(p=r[f],M=Math.sin(u*(.5+.5*P.seededRandom(f))*o+P.seededRandom(f)/u),A.current.position.set(p.x*M,p.y*M,p.z*M),A.current.rotation.z+=x*Math.cos((.5+.5*P.seededRandom(f))*o),A.current.rotation.y+=x*Math.cos((.5+.5*P.seededRandom(f))*o))})}),i.jsx(i.Fragment,{children:e.map((l,o)=>i.jsx(I,{ref:l,position:r[o],rotation:new re(...Array.from({length:3}).map((x,u)=>Math.PI*(2*P.seededRandom(o+u)-1))),...s},o))})},we=({coordinateMapper:s})=>{const{multi:e,helixLength:n,helixRadius:c,helixWindingSeparation:r,strandRadius:l,baseSpacing:o,strandOffsetRad:x,mirrorEffects:u,fixedBaseGap:p}=ae();return e?i.jsx(Ae,{coordinateMapper:s,helixLength:n,helixRadius:c,helixWindingSeparation:r,strandRadius:l,baseSpacing:o,strandOffsetRad:x,mirrorEffects:u,fixedBaseGap:p}):i.jsx(I,{coordinateMapper:s,helixLength:n,helixRadius:c,helixWindingSeparation:r,strandRadius:l,baseSpacing:o,strandOffsetRad:x,mirrorEffects:u,fixedBaseGap:p})},Ee=({...s})=>i.jsxs(i.Fragment,{children:[i.jsx(we,{...s}),i.jsxs(he,{children:[i.jsx(fe,{focusDistance:0,focalLength:.02,bokehScale:3,height:480}),i.jsx(xe,{luminanceThreshold:0,luminanceSmoothing:.9,height:300}),i.jsx(pe,{opacity:.02}),i.jsx(ge,{eskil:!1,offset:.1,darkness:1.1})]})]});export{Ee as default};
